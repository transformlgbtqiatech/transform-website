---
import { KnowledgeSidebar as KnowledgeSidebarReact } from "@components/react/KnowledgeSidebar";
import { getCollection } from "astro:content";

const _identityGroupsList = await getCollection("identity-groups");
const _violenceSubCategoriesList = await getCollection(
  "violence-sub-categories",
);
const _violenceCategoriesList = await getCollection("violence-categories");

const identityGroupsList = _identityGroupsList.map((item) => {
  return {
    slug: item.id,
    entry: item.data,
  };
});

const subCategoriesList = _violenceSubCategoriesList.map((item) => {
  return {
    slug: item.id,
    entry: item.data,
  };
});

const categoriesList = _violenceCategoriesList.map((item) => {
  return {
    slug: item.id,
    entry: item.data,
  };
});

type PreSelectedSlugs = {
  identityGroupSlug?: string;
  violenceSubCategorySlug?: string;
};

export type PreSelectedSlugsProp = {
  preSelectedSlugs?: PreSelectedSlugs;
};

type Props = {
  openKnowledgeSidebarByDefault?: boolean;
} & PreSelectedSlugsProp;

const { openKnowledgeSidebarByDefault, preSelectedSlugs } = Astro.props;
---

<KnowledgeSidebarReact
  client:idle
  identityGroupsList={identityGroupsList}
  subCategoriesList={subCategoriesList}
  categoriesList={categoriesList}
  openKnowledgeSidebarByDefault={openKnowledgeSidebarByDefault}
  preSelectedSlugs={preSelectedSlugs}
/>
